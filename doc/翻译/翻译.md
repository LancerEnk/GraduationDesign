# Blockene: A High-throughput Blockchain Over Mobile Devices
# Blockene：移动设备上的高吞吐量区块链
## 作者: 
Sambhav Satija and Apurv Mehra, Microsoft Research India; Sudheesh Singanamalla, University of Washington; Karan Grover, Muthian Sivathanu, Nishanth Chandran, Divya Gupta, and Satya Lokam, Microsoft Research India
## 摘要：
*我们引入了 Blockene ，这是一种区块链，它将成员节点的资源使用量减少了几个数量级，只需要智能手机即可参与区块验证和共识。尽管 Blockene 是轻量级的，但它提供了高吞吐量和可扩展到数百万参与者的规模。 Blockene 在智能手机中消耗微不足道的电池和数据，使数百万用户能够在没有激励措施的情况下参与区块链，以集体诚实的方式确保交易安全。 Blockene 通过一种基于将存储和 gossip 委派给不受信任节点的新型分离-信任设计来满足这些要求。
我们通过原型展示了 Blockene 提供1045个事务/秒的吞吐量，并在智能手机上以非常低的资源使用率运行它，这为构建安全、分散的应用程序指明了一个新的范例。*
## 1 介绍
区块链提供了一种强大的系统抽象：它们允许相互不信任的实体（成员）以分散的方式共同管理交易账本。
如今，所有区块链都需要成员节点运行具有大量网络、存储和计算资源的强大服务器。基于工作证明的区块链将资源使用推到了极致，需要大量的计算来解决难题，但即使是基于股权证明的联盟链和区块链也会产生大量的网络和存储成本，以使区块链在高交易吞吐量下保持最新状态。因此，如今的区块链仅限于成员具有强烈参与动机的用例，因此可以承担高昂的资源成本。例如，在联盟链中，业务效率提高，而在加密货币中，成员赚取货币。
有趣的是，区块链的高资源需求也削弱了一些真实应用的可靠性。区块链要求大多数(通常是三分之二)成员是诚实的，当大量成员参与时，这种特性更容易得到保证。然而，考虑到高资源需求，区块链的广泛采用是困难的，特别是在成员没有直接参与激励的情况下。毫不奇怪，如今成员数量较多的公共区块链以加密货币为目标。在本文中，我们介绍了 *Blockene* ，这是一种超轻量级、大规模的区块链，它为现实世界的交易提供了高吞吐量。凭借其轻量级和可扩展性，它能够被数百万用户广泛采用。通过实现大规模的参与， *Blockene* 使多数诚实的假设成为可能。凭借高吞吐量， *Blockene* 支持真实世界的事务速率。 *Blockene* 的关键突破在于，它不再要求成员运行强大的服务器，而是成为第一个使成员能够以一流公民身份参与共识的区块链，即使在像智能手机这样的轻量级设备上运行，也可以降低数量级的成本。
**网络**：区块链依赖于成员之间的 p2p gossip 算法；在高交易速率下， gossip 每天需要数十GB的数据传输； *Blockene* 在智能手机上每天只需要60MB的数据传输。
**存储**：区块链中的成员节点保留整个区块链的副本（高吞吐量时为TB）；在 *Blockene* 中，成员只需要几百MB的存储空间。
**计算**：即使是典型区块链的 gossip 成本也会耗尽移动节点的电量； *Blockene* 确保电池每天的消耗量低于3%。
因此，用户在运行 *Blockene* 时不会产生明显的成本。由于 *Blockene* 的资源使用率较低，即使在智能手机上也是可行的，因此 *Blockene* 也可以在台式机上运行，其资源使用比最先进的设备要少得多。
*Blockene* 实现了三个相互冲突的财产：大规模参与、高吞吐量和轻量资源使用，迎合没有直接激励的情况（例如利他主义参与），以及处理包括公共资金在内的各种用途的交易。 *Blockene* 与其他区块链架构的比较如表1所示。
示例应用：经审计的慈善事业。全世界每年向非营利组织的慈善捐款超过5000亿美元。然而，从捐赠者的角度来看，资金最终使用缺乏透明度，使得捐款容易被非营利组织利用或管理不善，特别是在监管执法不力或因腐败而受损的地区。一个提供从捐赠者到最终受益人的公开、端到端资金跟踪的系统，除了激励捐赠者之外，还会对非营利组织施加市场压力。区块链可以提供这种跟踪，但考虑到所涉及的资金规模，一个小的成员联盟不能被信任来运营区块链。理想情况下，这样的区块链应该由数百万公民无私地共同控制。政府/公共支出也有类似要求。
***Blockene* 的关键技术**:  *Blockene* 采用了一种新颖的系统设计，该系统基于一种新的安全模型——分离信任架构。区块链中有两种类型的节点：公民节点和政治节点。公民在智能手机上运行，是区块链的真正成员，即他们在共识协议中拥有投票权；因此，我们假设三分之二的公民是诚实的（这是数百万公民的合理假设）。另一方面，政客在服务器上运行，不受信任，即不参与共识。政客人数较少（只有几百人），我们只要求其中20%的人诚实。尽管政客们做着存储区块链等繁重的工作，但我们的协议能确保即使80%的政客与三分之一的恶意公民勾结，公民也能够检测和处理恶意行为。公民通过使用一种被称为复制可验证读取的新原语来应对政客的高度不诚实：公民从多个政客那里读取相同的数据，即使其中一个（共25个政客）是诚实的，也可以得到正确的数据。
公民通过运行拜占庭共识来执行事务验证，并决定要提交的区块和由此产生的全局状态。为了让数百万公民达成共识，*Blockene* 借用了 Algorand 的一个想法（经过修改，使其电池友好），在那里，一个不同的（约2000）公民随机委员会被加密选择为每个区块运行共识。与 Algorand 不同，*Blockene* 在委员会成员参加会议前几分钟将他们的信息公开: 这使 *Blockene* 能够降低在“公民”上的数据和电池成本。虽然这似乎增加了对委员会进行有针对性攻击的机会，但我们在§4.2中讨论了为什么这不是一个严重的问题。
为了降低公民的存储/通信成本，只有政治家才能存储区块链和全球状态（即关键值对），从而使公民不必 gossip 所有区块（约50GB/天）。公民只从政客那里读取一小部分数据（例如，当前区块交易的关键值），然后写出新区块。此外，由于政客不受信任，公民无法依赖他们返回的最新正确值，例如给定的密钥。 *Blockene* 使用了一种基于采样的 Merkle 树读/写的新技术，该技术降低了通信成本，同时确保了对80%的恶意政客的容忍度。
在委员会中，公民通过政治家而不是直接 gossip 来减少他们的沟通成本; 公民写的数据在政治家中被 gossip ，而感兴趣的公民从政治家那里阅读。
由于 *Blockene* 的参与是轻量级的，因此系统需要防止 Sybil 攻击；防止对手旋转大量虚拟节点以获得不成比例的投票份额。
为了阻止此类攻击，*Blockene* 要求参与者身份由大多数智能手机中可用的可信硬件（TEE）认证，并强制每个TEE在区块链上最多只能有一个活动身份，从而将参与的经济成本提高到唯一智能手机的成本。
为了限制80%的恶意政客对性能造成的损害，*Blockene* 采用了几种技术来限制他们说谎的能力。首先，我们使用一种称为预声明承诺的技术来检测一些恶意行为。第二，为了在80%的人不诚实的情况下，在政客之间可靠而高效地传播 gossip，我们引入了一种被称为优先 gossip 的新技术。这些技术降低了Citizens的成本，使 *Blockene* 能够在智能手机上运行的情况下实现高吞吐量。
我们已经建立了一个 *Blockene* 的原型，公民节点实现为一个 Android 应用程序，政客节点实现为一个云服务器。我们从各个维度评估了 *Blockene* ，并表明它实现了1045个事务/秒（6.8 MB/分钟）的良好事务吞吐量，同时确保了第99百分位的提交延迟为270秒。我们还展示了政客具有非常少的数据使用（61MB/天）和电池使用（3%/天）。
本文的主要贡献如下：
- 我们提出了第一个区块链系统，在该系统中，节点可以作为一流成员参与共识，同时在智能手机等轻量级设备上运行，支持高规模的成员和高吞吐量。
- 我们提出了一种新的分离信任设计，该设计具有一个新的安全模型，该模型由资源受限的公民（诚实的大多数）和资源密集的政客（不诚实的大多数）组成，公民通过以可验证的方式将繁重的工作交给不受信任的政客来执行验证和共识。
- 我们进行了一些新颖的优化（例如，预先声明的承诺、基于采样的 Merkle 树读/写、优先级 gossip ），尽管80%的政客是恶意的，但这些优化仍能取得良好的性能。
- 通过深入的理论分析，我们证明了 *Blockene* 满足安全性、活性和公平性。
- 我们对该架构进行了全面的实证评估，证明了其作为共享可扩展的区块链服务的可行性。
- 本文的其余部分结构如下：在§2中，我们提供了区块链的背景知识，并在§3中讨论了现有的区块链架构。§4概述了 *Blockene* 及其威胁模型，§5介绍了其设计。我们在§6中讨论了对资源密集步骤的优化，在§7中提供了安全性和活性证明，并在§8中描述了它的实现。我们在§9中评估了 *Blockene* ，并得出结论（§10）。

## 2 背景
在本节中，我们将讨论区块链中的关键原理和抽象及其应用。
### 2.1 基本属性
区块链是交易的分布式账本。在没有可信机构（例如银行）管理账本的情况下，一组相互不可信的各方共同验证交易，并维护一致的账本，前提是至少有一定数量的参与者（例如三分之二）是诚实的。区块链必须提供安全性、活跃性和公平性。安全性确保诚实的参与者对账本有一致的看法。活跃性确保恶意参与者不能通过阻止新的块添加来无限期地拖延区块链。公平性确保提交到区块链的所有有效交易最终得到提交。
### 2.2 建立区块链
区块链是一个复制的、对等的分布式系统，建立在以下基本原理之上:
**用于全局状态的Merkle树**：区块链的一个关键部分是跟踪键及其当前值的全局状态数据库。这种全局状态以防篡改的方式进行管理，通常使用 Merkle 树，其中叶节点包含键-值对，而每个中间节点包含子节点连接内容的哈希散列。根是表示整个状态的单个哈希值。键的更新只需要沿着从该叶到根的路径重新计算哈希。给定根，任何键的值都可以通过到根的有效散列路径来证明。
**签名交易**：区块链中的基本工作单位是交易。一次交易读取并更新全局状态中的一些键（例如，从Alice向Bob转账1000美元）。为了有效，（a）交易必须是被签名的（b）给交易签名的用户必须有权访问密钥（c）“语义”完整性必须通过（例如，不能超支）。
**加密链接**：区块链是区块的列表。块是事务的列表。通过加密链接确保块的排序；每个块都嵌入前一块内容的加密哈希散列。
**gossip**：处于区块链交换状态的参与者以点对点的方式相互交换。例如，当一个新块被提交到账本里时，它必须被发送给其他成员。这种交流是通过多跳 gossip 进行的，并最终保持一致。
**共识协议**：区块链中的关键原语是分布式共识协议，它处理拜占庭故障（例如，PBFT、Nakamoto 或 BBA），因为少数参与者可能是恶意的。拜占庭式共识要求至少2/3的参与者诚实，并需要多轮沟通。
## 3 与现有区块链的比较
在本节中，我们简要介绍了现有区块链架构的相关工作。 **Blockene** 提供了三个特性：轻量级资源使用、大规模参与和高事务吞吐量。我们使用相同的三个维度将 **Blockene** 与相关工作进行比较。
### 3.1 成员节点使用的资源
现有的区块链在参与成员节点的资源使用方面具有广泛的范围，这取决于用于一致性的机制。我们首先讨论成员的计算成本，然后讨论网络和存储成本。
**计算成本**。就计算成本而言，最昂贵的是基于 Nakamoto 共识的区块链，也称为工作证明；例如比特币和以太坊。在 Nakamoto 共识中，第一个解决计算密集型密码难题的成员节点被选为提交新块的获胜者。因此，这样的区块链在成员节点处需要大量的计算资源。
为了解决工作证明区块链的高计算（和能源）成本，出现了两种流行的替代架构。第一种是联盟链（例如 HyperLedger ），通过将区块链成员限制在少数节点，它可以运行传统的拜占庭共识算法，而不是基于计算密集型工作证明的共识。第二种体系结构是股权证明区块链，它将成员节点的投票权与成员节点在区块链上的资金数量联系起来。这些区块链的例子有 Algorand、 Ouroboros、 PeerCoin 等。从本质上讲，股份证明区块链针对的是加密货币应用程序，这种“股份”是有意义的。
**网络和存储成本**。尽管上述两种架构（即联盟链和股权证明区块链）解决了成员节点的原始计算成本，但它们对于智能手机来说仍然太昂贵。特别是，它们占用了大量的网络和存储资源，因为它们要求成员节点始终与区块链的“当前”状态保持最新。考虑到这种区块链实现的高交易速率（每秒1000笔交易），跨成员节点复制整个状态的成本很高：在1000笔交易/秒时，区块链每天将提交大约9GB的数据，这需要在成员节点之间传播 gossip ，导致每个成员节点必须承担大约45GB/天的网络成本（假设一次 gossip 会辐射给五个邻居）。此外，这样的区块链将在成员节点上消耗TB的存储，因为每个成员节点都存储区块链的本地副本。
即使是针对智能手机的区块链也采用了相同的理念，即成员节点不断更新，从而导致网络和存储开销。一些区块链通过分片处理存储成本。OmniLedger 是最新的一个区块链，它允许参与者只存储区块链的一个碎片。它使用 Byzcoin（比兹币） 的一个变体来快速达成共识。 RapidChain 还使用分片来降低存储成本。这两项工作的规模仅限于几千名参与者，而且还要求参与者存储整个区块链的大部分（1/3或1/16）。
**轻量级但无法使用的节点**。一类“轻量级”区块链采用了“不平等成员”的方法：只有第一层资源密集的成员参与共识并拥有投票权，而第二层成员只是作为只读查询前端，不参与共识。在这样的模型中，“多数诚实”属性必须完全由重节点来满足，因为轻节点对安全性没有贡献。毫不奇怪，由于责任有限，“轻”节点不会消耗太多资源。这种架构的一个例子是以太坊中轻节点和重节点之间的分离。
***Blockene***。相比之下， *Blockene* 为参与共识和区块验证的一流成员实现了轻量级的资源使用。此外，与以太坊不同，以太坊依赖于重节点中的诚实多数（只有重节点才能投票），*Blockene* 容忍高达80%的“重”节点（即政客）腐败。 *Blockene* 的成员只需要一部智能手机和可忽略不计的数据传输（<60 MB/天，即低三个数量级）和可忽略不计的计算（每天电池使用率<3%）。它通过使成员节点能够以提交特定块所需的最小状态进行操作，并且每天只执行几次工作，即不努力始终保持最新状态来实现这一点。
### 3.2 参与程度
由于区块链的安全性基本上依赖于大多数参与成员的诚实，区块链需要防止大量参与者的串通。联盟区块链为特定的业务流程精心构建区块链，使成员在区块链的成功中拥有共同的激励。有时，用上述担保组建联合体是不可行/困难的；在慈善事业的例子中，如果少数成员控制着区块链，他们可能会串通起来，比如，为穷人的捐赠提供便利。此外，联盟区块链与一组实体之间的特定业务流程紧密相连，除了限制互操作性之外，还导致了高设置和运营开销。
防止多数人勾结的另一种方法是实现大规模参与；通过招募大量参与者（比如数百万人），多数人的勾结可能变得困难且不太可能。比特币、以太坊和 Algorand 等大多数“公共”区块链都能实现大规模参与。 *Blockene* 也支持大量参与者，但与当今大多数以加密货币为目标的公共区块链不同， *Blockene* 不与加密货币绑定（例如，没有股权证明），而是支持通用业务交易。与联盟区块链不同， *Blockene* 还可以在少数成员之间存在潜在勾结的现实世界场景中启用。
### 3.3 交易吞吐量
基于工作证明的公共区块链吞吐量低（约4-10个事务/秒）。基于股权证明的 Algorand[21] 是第一个拥有约1000笔交易/立方秒的公共区块链3联盟区块链，由于参与者规模较小，且传统共识（如PBFT），每秒可提供1000笔交易。
与 Algorand 类似，*Blockene* 也提供高交易吞吐量。通过不与加密货币应用程序绑定，*Blockene* 可以为类似于联盟区块链的传统商业应用程序提供服务。
|       Blockchain       | Scale of members |     Trans.rate     |    Cost    | Incentive needed? |
|:----------------------:|:----------------:|:------------------:|:----------:|:-----------------:|
|  Public (e.g.,Bitcoin) |   **Millions**   |     4-10 /sec.     | Huge (PoW) |        Yes        |
| ConSortium (e.g.,[13]) |       Tens       |   **1000s /sec.**  |    High    |        Yes        |
|      Algorand[21]      |   **Millions**   | **1000-2000/sec.** |    High    |        Yes        |
|      **Blockene**      |   **Millions**   |   **1045 /sec.**   |  **Tiny**  |       **No**      |
表 1 区块链架构比较
### 3.4 对参与者的激励
由于资源成本高（计算、网络或存储），现有区块链需要对参与者进行激励（例如，在加密货币中挖掘硬币，或在联盟中提高业务效率）。依赖此类激励的区块链无法用于慈善等应用（§1）。为了在没有激励的情况下扩大规模并实现利他参与，参与的成本必须可以忽略不计。
表1从这些维度比较了区块链架构。 *Blockene* 是第一个实现以上所有功能的区块链：规模、吞吐量和低成本。凭借低成本， *Blockene* 支持真实世界的用例，即使参与者没有直接的激励，但他们愿意以微不足道的电池和数据使用量无私的运行后台应用程序。
### 3.5 其他相关工作
*Blockene* 基于委员会的共识很大程度上受到了 Algorand 的启发，与 *Blockene* 一样，Algorand 也不允许出现分叉，并且对区块链始终保持一致的观点。 Algorand 和 *Blockene* 在抵御两种目标攻击的能力上存在权衡（见§4.2第1段）。HoneyBadger[28]是最新的专为O（100）个参与者的联盟区块链设计的系统。IOTA[19，20]是另一个分布式账本系统，但目前依赖于一个集中的协调员来达成共识。
在基于工作证明的区块链中，与 *Blockene* 最密切相关的工作是混合共识[31]。与 Algorand（和 *Blockene* ）类似，混合共识定期选择一组参与者，并且不允许对手在“参与者选择间隔”期间破坏节点。然而，它有一个很长的选择间隔（大约1天），也有分叉的可能性。
## 4 体系结构概述
在本节中，我们首先介绍我们的两层体系结构，它实现了轻量级资源使用、大规模参与和高事务吞吐量这三个相互冲突的属性。然后我们讨论了 *Blockene* 的威胁模型。
### 4.1 双层架构
*Blockene* 采用了一种具有不对称信任的新型双层架构。该架构如图1所示。
*Blockene* 中有两种节点：公民和政治家。公民资源有限（即使用智能手机），人数众多（数百万），是系统中唯一拥有投票权（即参与共识）的实体。政客们很强大，运行着服务器（类似于Algorand这样的现有区块链），人数也少很多（只有几百人），但他们没有投票权。政客只执行公民做出的决定，而不能自己做出任何决定。
低资源使用率使大量公民能够在没有激励的情况下参与，而政治家人数很少，将由对特定用例感兴趣的大型实体（例如，在经过审计的慈善案例中，大型捐助者和基金会）管理。
由于公民参与了共识，至少三分之二的公民被要求诚实，而其他人可能恶意串通。这是合理的，因为 *Blockene* 允许数百万公民参与，使大规模腐败变得困难。然而，政客们的信任度要低得多。 *Blockene* 只要求20%的政客诚实；剩下的80%的政客可能心怀恶意，相互勾结，还有三分之一的恶意公民。
#### 4.1.1 把工作交给政客
从直觉上讲，考虑到双层架构，公民可以将存储和通信等昂贵的责任推卸给政治家。然而，由于80%的政客都是腐败的，一个公民所写的内容可能会被政客丢弃，或者，一个读操作可能会返回不正确的值。为了让政客们完成有用的工作，*Blockene* 使用了一种复制读写的新机制。公民对政客的读和写都是在随机安全的政治家样本中进行的。该样本的大小是固定的，以便在高概率下，样本中至少有一个政客是诚实的(例如，样本大小为25，这个概率是 1-(0.8)^25=99.6%)。*Blockene* 对于少数公民(占比0.4%)挑选所有不诚实的政客很有弹性。
#### 4.1.2 职责分工
我们现在描述公民和政治家如何合作执行各种标准区块链任务：
**存储**：在传统区块链中，每个参与者都保存着整个区块链的副本，但 *Blockene* 的公民无法负担存储TB级别的数据。在 *Blockene* 中，只有政客存储账本和全局状态（即关键值数据库§2）。公民根据需要从政客那里读取这些数据的子集。唯一的州公民存储（并定期更新）是一个有效的公民身份列表（§5.3）。
**交易验证**：由于公民是共识的实际参与者，他们验证交易，确保交易已被签署，并具有语义完整性（例如，没有重复支出）。为了执行验证，公民从政客那里读取交易，并从政客的全局状态中查找其中引用的密钥的最新值。然后，公民提出一个拥有有效交易的区块。
**gossip**：为了确保所有诚实的参与者都同意区块链的状态，参与者需要相互 gossip 。然而，正如§3所讨论的，公民之间的直接 gossip 是昂贵的。*Blockene* 通过让公民通过政客八卦来解决这个问题。当一个公民需要向其他公民广播信息时，它会向安全的政客样本发送信息。然后，政客们互相 gossip 数据；他们有能力这样做，因为他们有良好的网络连接。当其他公民需要时，例如当他们在委员会中时，他们会重复从政客那里阅读。对于通过政客传播的gossip ，我们需要保证，一个诚实的政客传达的信息总是通过 gossip 传播给所有其他诚实的政客，当80%的政客是恶意的时，这是一个具有挑战性的属性；我们的自定义 gossip 协议在§6.1中进行了描述。因此，我们实现了与公民之间的直接 gossip 相同的语义，但公民的网络负载最小。
**共识**：公民通过政客的 gossip 参与共识。由于公民规模庞大，所有公民都无法参与共识。相反，我们用密码为每个街区随机选择一个公民委员会（约2000名成员）（§5.2）。

---

## 待翻译


---
## 特殊名词
Citizen node：公民节点
Politician node：政客节点
proof-of-state：股权证明，PoS
consortium blockchains：联盟链
[gossip](https://www.cnblogs.com/X-knight/p/9909367.html)：gossip代表了一种可最终达到一致的算法。其灵感来源于办公室八卦：当一个八卦在办公室出现时，在一定阶段内通过散播（dissemination），所有人最终都会知道这个八卦。
[Byzantine failures](https://blog.csdn.net/xuxilei0503/article/details/26347697)
Byzcoin：比兹币
