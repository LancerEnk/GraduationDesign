# 毕设的思路细化 - 对路径规划算法的改进

> 针对 “0316_交流结果” 的新一轮交流

## 整理出的三个大环节

### 01 前端的熟悉环节

1. **更新前端**：把万琦玲前辈的前端做进当前的系统里，使后续的一切改动打在牢固完善的基础上。

2. **使用九宫格地图进行测试**：

    * 周畅前辈、成佳壮前辈过往的工作中，应该是有现成的九宫格地图可以进行调用的 **->** 找出它 or 自己重画

### 02 规划算法的修改

**没车**：道路初始化时没有车，但道路会有本身的限速，则 限速 = $V_{default}$

**有车**：用评价函数 $V(n)$ 将道路上通过的n辆车的速度加权计算出道路的平均速度 $V_{path}$。

> $↓$ 0316的思路在路况判定和处理处有误，在此对其进行记录和修正 $↓$

根据 $V_{path}$ 判断道路路况时，不能使用 “将 $pathState$ 置为0和1” 的思路。

* **原因**：如果 ${path}_{1}$ 发生拥堵，就把车辆全部分流到另一条道路 ${path}_{2}$ 上去，这样会导致路况发生振荡，而实际上应该是让路况保持一段时间的稳定。

* **解决方法**：把实时路况（以 $V_{path}$ 为量化数据）当作权重，融合进代价计算函数中。

  * **实时路况计算思路**：$${（历史路况 + 现实路况）}_{加权} = 实时路况$$
    * 变量意义
      * 历史路况：第 n-1 次计算出的路况
      * 现实路况：第 n 次获取到的真实路况
      * 实时路况：第 n 次计算出的路况
      * 在加权时需要考虑 `阻尼系数`，该系数用来调整 `历史路况`、`现实路况` 的不同权重，使实时路况在尽量保持平稳的状况下及时得到更新。
        * <u>阻尼系数对实时路况计算的影响</u>：
          * 如果阻尼系数选取的不好，则会存在以下的不同情况
            * (1)`实时路况受现实路况影响较大`，一旦现实路况计算出错（在通过路口、立交桥等地时，在未对此地区进行标注的情况下，可能会存在车辆移动距离为负数、通过当前路段时间过长...等问题）。此时，实时路况很容易被这些问题影响，从而变得不可靠。
            * (2)`实时路况受历史路况影响较大`，此种情况下，现实路况的上传对实时路况的更新起不到效果，实时路况将会趋于初始路况不易改变。

  * **代价计算函数**：
  $$
  f(n)=g(n)+h(n) \\
  {\color{White}---------} \\
  道路权重\left\{\begin{matrix}
  实时路况 V_{path}{\scriptsize \color{Blue} (StoreMap.sol里没有，需要添加)} \\
  道路长度cost {\scriptsize \color{Blue}(StoreMap.sol里已有，不需改动)}
  \end{matrix}\right.
  $$
    * g(n)：耗散函数，从起始点到第 n 个中间位置节点的实际距离。
    * h(n)：启发函数，算法过程查询到的中间节点到目的地节点的距离估计值，曼哈顿距离。

### 03 抽样速度的选取

在进行大规模数据测试时，上传真实路况的环节中，上传频率的选取至关重要。

* 如果`上传频率太快`，则会导致路况变化太快，在路口、立交桥等处的路况计算必定会丢失精准性。
* 如果`上传频率太慢`，则会失去路况的实时性。
* 所以此环节中的关键点在 **`调参`**

### 04 (根据0316交流更新)对我即将要完成的内容的整理分析

1. **熟悉前端**
    * 把万琦玲前辈的前端做进当前的系统里，使后续的一切改动打在牢固完善的基础上。（正在进行中）

2. **地图的转换**：把上传的地图修改成一个九宫格，在九宫格的基础上进行测试
    * 掌握地图的划分方法，比如究竟哪块对应着哪个区域，能有一个具体的思考理解

3. **新的测试方法** - 把自动化测试的脚本修改成多乘客多车辆，在地图九宫格的基础上进行测试

4. 实现**每隔一段时间，车辆上传一次位置**的功能

5. **添加实时路况计算代码，改动A*算法代码**
    * 按照《00 本模块的具体思路》撰写代码，进行测试
